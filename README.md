# ClickCapture - スクリーンキャプチャツール for Windows

 <!-- TODO: アプリケーションのスクリーンショットをここに挿入してください -->

**ClickCapture**は、Windowsユーザー向けに設計された、スクリーンキャプチャツールです。マウスドラッグによる簡単なエリア選択、画像保存(JPEG)、PDF変換、自動連続キャプチャなどを備えたネイティブアプリケーションです。

このツールは、Amazon Kindleなどの電子書籍をPDF化したり、ウェブページの特定部分を高品質で保存したり、スライドや電子書籍をページをめくりながらキャプチャするなど、多様な用途に対応するために作成しました。

✅ **キャプチャとページ送りをワンクリックで：**
キャプチャモード中のクリックは、スクリーンショットを撮った後、背後にあるアプリケーション（電子書籍ビューアなど）にもそのまま伝わります。そのため、電子書籍の「次へ」ボタンをクリックするだけで、**キャプチャとページ送りが同時に**行え、書籍のPDF化が非常に効率的になります。

✅ **全自動の連続キャプチャ：**
さらに「自動クリック機能」を有効にすると、最初のクリックをきっかけに、指定した回数・間隔で**同じ場所へのクリック操作とキャプチャを自動で繰り返します**。これにより、完全にハンズフリーで連続したページをキャプチャできます。


![clickcapture](https://github.com/user-attachments/assets/a8fe62aa-8ba1-4e78-9620-8dc6f58e61ae)


---

## ✨ 主要機能

- **🔍 エリア選択**: マウスをドラッグするだけで、キャプチャしたい領域を正確に選択できます。半透明のオーバーレイとリアルタイムで描画される選択範囲により、操作は非常に直感的です。
- **📸 ワンクリック・キャプチャ**: エリア選択後、キャプチャモードで画面上のどこかを左クリックするだけで、指定した領域のスクリーンショットが即座に保存されます。
- **🖱️ 自動連続キャプチャ**: 指定した回数と間隔で、自動的にスクリーンショットを連続撮影できます。Webページのスクロールキャプチャや、動画のコマ撮りなどに便利です。
- **📄 PDF一括変換**: 保存先のフォルダに溜まったJPEG画像を、ワンクリックで一つのPDFファイルにまとめることができます。ファイルサイズの上限設定も可能です。
- **⚙️ 品質設定**:
  - **画像スケール**: 保存する画像の解像度を55%〜100%の範囲で調整し、ファイルサイズをコントロールできます。
  - **JPEG品質**: 70%〜100%の範囲でJPEGの圧縮品質を設定できます。
- **📁 保存先管理**: デフォルトでPCの「ピクチャ」フォルダに保存されますが、OneDrive上のフォルダも自動検出し、手動での変更も簡単です。
- **⌨️ ESCキーによる高速キャンセル**: エリア選択モードやキャプチャモードは、いつでも`ESC`キーを押すだけで安全にキャンセルできます。
- **🚀 ネイティブパフォーマンス**: RustとWin32 APIで構築されており、軽量なメモリ使用量と高速なレスポンスを実現しています。

---

## 💿 インストール

### ソースからのビルド

開発やカスタマイズを行いたい場合は、以下の手順でソースコードからビルドできます。

**必要なもの:**
- Rustツールチェイン
- Git

**手順:**

1.  リポジトリをクローンします。
    ```sh
    git clone https://github.com/your-username/clickcapture.git
    cd clickcapture
    ```

2.  リリースモードでビルドします。
    ```sh
    cargo build --release
    ```

3.  ビルドが完了すると、`target/release/clickcapture.exe`に実行ファイルが生成されます。

---

## 📖 使い方

### 1. 起動と保存先の設定

- `clickcapture.exe`を起動すると、メインダイアログが表示されます。
- 保存先は、デフォルトでPCの「ピクチャ」フォルダが設定されています。
- **「参照」ボタン (<img width="20" height="20" alt="image" src="https://github.com/user-attachments/assets/43712789-5124-4d26-a950-367e606db568" />
)** をクリックすると、スクリーンショットの保存先フォルダを自由に変更できます。

### 2. エリア選択

1.  **「エリア選択」ボタン (<img width="20" height="20" alt="image" src="https://github.com/user-attachments/assets/d9f60316-b98b-4c5d-b88f-25f6228a25a1" />
)** をクリックします。
2.  画面全体が半透明の黒いオーバーレイで覆われます。
3.  キャプチャしたい範囲をマウスでドラッグします。ドラッグした範囲がくり抜かれ、赤い枠線で表示されます。
4.  マウスボタンを離すと、選択したエリアが確定します。
5.  この操作はいつでも **`ESC`キー** でキャンセルできます。

### 3. キャプチャの実行

1.  **「キャプチャ開始」ボタン (<img width="20" height="20" alt="image" src="https://github.com/user-attachments/assets/f3ab53c7-f372-4795-bf2d-ff29c53b5d0e" />
)** をクリックします。ボタンが点灯し、キャプチャモードが開始されます。
2.  先ほど選択したエリアが、画面上に赤い枠線で表示されます。
3.  画面上のどこでも **左クリック** すると、枠内の領域が撮影され、指定したフォルダに連番（`0001.jpg`, `0002.jpg`, ...）で保存されます。
4.  キャプチャモードは **`ESC`キー** でいつでも終了できます。

### 4. 自動連続キャプチャ

1.  メインダイアログで **「連続クリック」** のチェックボックスをオンにします。
2.  **「回数」** と **「間隔」** を設定します。
3.  キャプチャモード中に左クリックすると、一度のクリックをトリガーにして、設定した回数・間隔で自動的に連続キャプチャが実行されます。

### 5. PDFへの変換

1.  **「PDF変換」ボタン (<img width="20" height="20" alt="image" src="https://github.com/user-attachments/assets/757c88b5-25af-4a66-acba-604cd73c9e3b" />
)** をクリックします。
2.  確認ダイアログが表示された後、保存先フォルダ内にあるすべてのJPEG画像が、一つのPDFファイルにまとめられます。
3.  PDFの最大ファイルサイズはコンボボックスから設定できます。

### 6. 各種設定

- **スケール**: 保存される画像の解像度を調整します。値を小さくするとファイルサイズを削減できます。
- **JPEG品質**: JPEG画像の圧縮品質を調整します。
- **PDFサイズ**: PDF変換時に、1ファイルあたりの最大サイズを設定します。上限を超えると自動的にファイルが分割されます。（※現在のバージョンでは単一ファイル生成）

### 7. 終了

**「閉じる」ボタン (❌)** またはウィンドウ右上の閉じるボタンでアプリケーションを安全に終了します。

---

## 🛠️ 技術仕様

- **言語**: Rust 2021 Edition
- **UIフレームワーク**: Win32 API (ネイティブ)
- **描画エンジン**: GDI+ (ハードウェアアクセラレーションによる高速な透過描画)
- **イベント処理**: 低レベルシステムフック (`WH_MOUSE_LL`, `WH_KEYBOARD_LL`)
- **画像処理**: [image](https://crates.io/crates/image) クレート
- **PDF生成**: [lopdf](https://crates.io/crates/lopdf) クレート
- **その他のクレート**：
 - [once_cell](https://crates.io/crates/once_cell)
 - [num-format ](https://crates.io/crates/num-format)

---

## 📜 ライセンス

このプロジェクトは MITライセンス の下で公開されています。
<!-- TODO: プロジェクトのルートにLICENSEファイルを追加してください -->
